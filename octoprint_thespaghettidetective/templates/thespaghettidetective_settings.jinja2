<div class="header">
    <img class="logo pull-left" src="/plugin/thespaghettidetective/static/img/logo-square.png" /> <h3>The Spaghetti Detective</h3>
    <p><a href="https://thespaghettidetective.com/" target="_blank">The Spaghetti Detective</a> is <strong>open source project</strong> for 3D printing remote monitoring. It uses AI (Deep Learning) to detect print failures in real time and alerts you about them.</p>
</div>
<div class="tabbable"> <!-- Only required for left/right tabs -->
  <ul class="nav nav-tabs">
    <li class="active"><a href="#setup" data-toggle="tab">Setup</a></li>
    <li><a href="#advanced" data-toggle="tab">Advanced Settings</a></li>
    <li><a href="#problems" data-toggle="tab">Got Problems?</a></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active" id="setup">
        <h5>Step 1: <a data-bind="attr: { href: settingsViewModel.settings.plugins.thespaghettidetective.endpoint_prefix() + '/secure_redirect/?target=/accounts/signup/&source=plugin' }" target="_blank">Sign up</a> an account.</h5>
        <p>Be sure to check our <a href="https://thespaghettidetective.com/privacy.html" target="_blank">Privacy Policy</a> and <a href="https://thespaghettidetective.com/terms.html" target="_blank">Terms of Use</a>.</p>
        <h5>Step 2: Add a printer in The Spaghetti Detective and obtain its secret token.</h5>
        <div>Secret token is the key that makes sure only you can access data in your account, not anyone else.</div>
        <h5>Step 3: Copy the secret token to the box below.</h5>
        <form class="form-horizontal">
            <div>If you have problem locating the secret token, click <a data-bind="attr: { href: settingsViewModel.settings.plugins.thespaghettidetective.endpoint_prefix() + '/secure_redirect/?target=/printer_auth_token/0/&source=plugin' }" target="_blank">here</a>.</div>
            <div class="input-append token-input">
                <input type="text" class="input-block-level auth-token-input" data-bind="value: settingsViewModel.settings.plugins.thespaghettidetective.auth_token">
                <button class="btn test-auth-token" type="button"><i class="fa fa-spinner fa-spin" style="display: none;"></i> Test</button>
            </div>
            <div class="std-api-status">&nbsp; </div>
        </form>
        <div class="settings-video">
        <iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/VRoV9Z1C1yM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    </div>
    <div class="tab-pane" id="advanced">
        <form class="form-horizontal">
        <legend>Server</legend>
        <div class="control-group">
            <p>If you feel adventurous, head to <a href="https://github.com/TheSpaghettiDetective/TheSpaghettiDetective">our source code</a> and set up your own server. Then enter your Server Address below:</p>
            <label class="control-label">{{ _('Server Address') }}</label>
            <div class="controls">
                <input type="text" class="input-block-level endpoint-prefix" disabled data-bind="value: settingsViewModel.settings.plugins.thespaghettidetective.endpoint_prefix">
                <div class="form-check" style="margin-top: 8px;">
                  <input class="form-check-input custom-server" type="checkbox" value="" style="margin-top: 0px;">
                  <label class="form-check-label" for="custom-server" style="display: inline">
                    I have my own TSD server (don't check this unless you know what you are doing).
                  </label>
                </div>
            </div>
        </div>
        <br />
        <legend>Premium Webcam Streaming</legend>
        <div data-bind="visible: !streaming.eligible">
          <div class="alert alert-warning" role="alert">
            Your account is not eligbile for premium webcam streaming. <a href="https://www.thespaghettidetective.com/docs/webcam-streaming-for-human-eyes/">Why?</a>
          </div>
        </div>
        <div data-bind="visible: streaming.eligible">
          <div class="alert alert-warning" role="alert">
            <h4>Restart required: </h4>
            The changes to any of the following settings won't be effective until OctoPrint is restarted.
          </div>
          <div class="control-group">
              <div class="controls">
                  <div class="form-check" style="margin-top: 8px;">
                    <input class="form-check-input custom-server" type="checkbox" data-bind="checked: settingsViewModel.settings.plugins.thespaghettidetective.disable_video_streaming" style="margin-top: 0px;">
                    <label class="form-check-label" for="custom-server" style="display: inline">
                      Disable premium webcam streaming. <a href="https://www.thespaghettidetective.com/docs/disable-25-fps-streaming/">(Why would I want to do that?)</a>
                    </label>
                  </div>
              </div>
          </div>
          <div data-bind="visible: (streaming.is_pi_camera() && !settingsViewModel.settings.plugins.thespaghettidetective.disable_video_streaming())" class="control-group" title="{{ _('Pi Camera resolution') }}">
              <label class="control-label" for="pi-cam-resolution">{{ _('Resolution') }}</label>
              <div class="controls">
                  <select data-bind="options: piCamResolutionOptions, optionsValue: 'id', optionsText: 'text', value: settingsViewModel.settings.plugins.thespaghettidetective.pi_cam_resolution" id="pi-cam-resolution"></select>
              </div>
          </div>
          <div data-bind="visible: !settingsViewModel.settings.plugins.thespaghettidetective.disable_video_streaming()" class="control-group">
              <label class="control-label">Compatibility mode<div><a href="https://www.thespaghettidetective.com/docs/streaming-compatibility-mode/">(What is it?)</a></div></label>
              <div class="controls">
                  <label class="radio">
                      <input type="radio" name="webcamCompatibleModeGroup" value="auto" data-bind="checked: settingsViewModel.settings.plugins.thespaghettidetective.video_streaming_compatible_mode"> Automatic (default). TSD will automatically switch to compatibility mode if necessary. Select this option if you are not sure.
                  </label>
                  <label class="radio">
                      <input type="radio" name="webcamCompatibleModeGroup" value="always" data-bind="checked: settingsViewModel.settings.plugins.thespaghettidetective.video_streaming_compatible_mode"> Always stream in compatibility mode
                  </label>
                  <label class="radio">
                      <input type="radio" name="webcamCompatibleModeGroup" value="never" data-bind="checked: settingsViewModel.settings.plugins.thespaghettidetective.video_streaming_compatible_mode"> Never stream in compatibility mode
                  </label>
              </div>
          </div>
          </form>
        </div>
    </div>
    <div class="tab-pane" id="problems">
        <legend>Trouble-shooting</legend>
        Here are a few things you can try in case you run into problems:
        <ul>
            <li>Check out the <a href="https://www.thespaghettidetective.com/docs/octoprint-plugin-setup/" target="_blank">Setup Guide</a> and be sure to follow the steps there.</li>
            <li>Hard-refresh this page and try again. Here is <a href="https://en.scratch-wiki.info/wiki/Help:Hard_Refresh">how you hard-refresh a page</a>.</li>
            <li><a href="#" data-bind="click: openErrorTrackerModal">Check plugin self diagnostic report >>></a></li>
            <li><a href="https://www.thespaghettidetective.com/docs/contact-us-for-support/">Contact us</a> for help!</li>
        </ul>
        <form class="form-horizontal">
        <legend>Error Reporting</legend>
                <div class="form-check" style="margin-top: 8px;">
                  <input class="form-check-input sentry-opt" type="checkbox" value="" data-bind="checked: sentryOptedIn, click: toggleSentryOpt" style="margin-top: 0px;">
                  <label class="form-check-label" for="custom-server" style="display: inline">
                    Report anonymized error informtation to The Spaghetti Detective developers to help them diagose the problem.
                  </label>
                </div>
       </form>
    </div>
  </div>
</div>
